<html>
<head>
<title>...........</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
<style>
form       {margin: 0px;}
input.edit {width: 100%;}
input.btn  {width: 100px; margin-bottom: 4px;}
textarea   {width: 100%; height: 100%;}
tr.fix     {height: 30px;}
tr.top     {height: 30px; background-color: #f0f0f0; text-align: center; font-weight: bold; height: 30px;}
td         {font-size: middle; padding-left: 10px; padding-right: 10px; padding-top: 4px; padding-bottom: 4px; vertical-align: top;}
td.quote   {vertical-align: bottom; padding-bottom: 2em; font-size: smaller;}
body       {margin: 0px; padding: 0px; background: white;}
</style>
</head>
<body>
<form name=forum method='post' onsubmit='return forum_submit(this)'>
<input type=hidden name='forum-rgs2000' value=1>
<script>
function setCookie(name, value, expires, path, domain, secure)
{
	var curCookie = name + "=" + escape(value) +
		((expires) ? "; expires=" + expires.toGMTString() : "") +
		((path) ? "; path=" + path : "") +
		((domain) ? "; domain=" + domain : "") +
		((secure) ? "; secure" : "");
	if ((name + "=" + escape(value)).length <= 4000)
		document.cookie = curCookie;
	else
		if (confirm("Cookie превышает 4KB и будет вырезан !"))
				document.cookie = curCookie;
}

var submitted = false;
function forum_submit(form)
{
	if (submitted)
		return false;

	var r = forum_check(form);
	if (r != null) {
		r[0].focus();
		window.scrollBy(0, -100);
		r[0].select();
		alert('Ошибка в поле "'+r[1]+'":\n'+r[2]);
		return false;
	}

	var exp = new Date();
	exp.setMonth(exp.getMonth()+6);
	setCookie("author_name", form["author_name"].value, exp);
	setCookie("author_mail", form["author_mail"].value, exp);
	
	submitted = true;
	return true;
}

function forum_check(form)
{
if (form['title'].value=='') return new Array(form['title'], "Тема сообщения", "Поле требует обязательного заполнения");
if (form['title'].value.length<5) return new Array(form['title'], "Тема сообщения", "Значение поля не может быть короче 5 символов");
if (form['title'].value.length>64) return new Array(form['title'], "Тема сообщения", "Значение поля не может быть длиннее 64 символов");
if (form['author_name'].value=='') return new Array(form['author_name'], "Имя автора", "Поле требует обязательного заполнения");
if (form['author_name'].value.length<2) return new Array(form['author_name'], "Имя автора", "Значение поля не может быть короче 2 символов");
if (form['author_name'].value.length>64) return new Array(form['author_name'], "Имя автора", "Значение поля не может быть длиннее 64 символов");
if (form['author_mail'].value!='') {
if (form['author_mail'].value.length>64) return new Array(form['author_mail'], "E-mail автора", "Значение поля не может быть длиннее 64 символов");
if (form['author_mail'].value.match(/^[\w\.\-]+@[\w\.\-]+\.[\w]{2,4}$/)==null) return new Array(form['author_mail'], "E-mail автора", "Поле принимает недопустимое значение");
}
if (form['body'].value=='') return new Array(form['body'], "Текст", "Поле требует обязательного заполнения");
}
</script>
<table width=100% height=100% cellpadding=0 cellspacing=0 border=0>
<tr class=top>
	<td colspan=3 id="win-title">...........</td>
</tr>
<tr class=fix><td width=120>Тема сообщения:</td><td colspan=2><input type=text id=title name=title maxlength=64 class=edit value=""></td></tr>
<tr class=fix><td width=120>Имя автора:</td><td colspan=2><input type=text id=author_name name=author_name maxlength=64 class=edit></td></tr>
<tr class=fix><td width=120>E-mail автора:</td><td colspan=2><input type=text id=author_mail name=author_mail maxlength=64 class=edit></td></tr>
<tr class=fix><td width=120></td><td colspan=2><input type=checkbox id=notify_answers name=notify_answers> Присылать копии ответов по почте</td></tr>
<tr><td width=120>Текст:</td><td colspan=2><textarea id=body name=body>
</textarea></td></tr>
<tr class=fix>
	<td></td>
	<td>
		<input type="submit" value="ОК" class=btn>
	</td>
	<td align=right>
		<input type="reset" value="Вернуть" class=btn>
		<input type="button" onclick="window.close()" value="Закрыть" class=btn>
	</td>
</td></tr>
</table>
</form>
</body>
<script>
function getObjectHandle (wnd, objectName )
{
	if (wnd.document.getElementById) {
		return wnd.document.getElementById(objectName);
	}
	if (wnd.document.all) {
		return wnd.document.all(objectName);
	}
}
function load()
{
	opener.forumEditLoaded(window);
	getObjectHandle(window,"title").focus();
}
window.onload = load;
function error()
{
	window.close();
	return true;
}
//window.onerror = error;

</script>
</html>
